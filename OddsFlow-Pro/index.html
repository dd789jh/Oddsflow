<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OddsFlow AI - æ™ºèƒ½è¶³çƒäº¤æ˜“ç»ˆç«¯</title>
    <meta name="description" content="OddsFlow AI - å®æ—¶è¶³çƒèµ”ç‡ç›‘æ§ä¸è‹±è¶…å¤§æ•°æ®åˆ†æã€‚">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: #e5e7eb; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .bg-glass { background: rgba(20, 20, 20, 0.6); backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.08); }
        
        /* åŠ¨ç”»ä¸å·¥å…·ç±» */
        .page-section { display: none; opacity: 0; transition: opacity 0.3s ease-in-out; }
        .page-section.active { display: block; opacity: 1; }
        .epl-logo-shadow { filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.1)); }
        
        /* è·‘é©¬ç¯ */
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        .ticker-wrap { overflow: hidden; white-space: nowrap; }
        .ticker-content { display: inline-block; animation: scroll 30s linear infinite; }
    </style>
</head>
<body class="antialiased h-screen flex flex-col overflow-hidden">

    <!-- 1. è·‘é©¬ç¯ -->
    <div class="bg-emerald-900/30 border-b border-emerald-500/20 h-8 flex items-center overflow-hidden shrink-0">
        <div class="ticker-wrap">
            <div class="ticker-content text-xs font-mono flex gap-8 text-emerald-400">
                <span>ğŸš€ SIGNAL: Kanchanaburi vs Nong Bua [Pressure Critical]</span>
                <span>ğŸ† EPL: Chelsea vs Burnley Upcoming</span>
                <span>ğŸ’° VALUE: High Confidence Bets Detected</span>
                <span>ğŸš¨ ALERT: Late Game Pressure Spike</span>
                <!-- é‡å¤ -->
                <span>ğŸš€ SIGNAL: Kanchanaburi vs Nong Bua [Pressure Critical]</span>
                <span>ğŸ† EPL: Chelsea vs Burnley Upcoming</span>
                <span>ğŸ’° VALUE: High Confidence Bets Detected</span>
                <span>ğŸš¨ ALERT: Late Game Pressure Spike</span>
            </div>
        </div>
    </div>

    <!-- 2. å¯¼èˆªæ  (æ–°å¢äº† è‹±è¶…èµ›ç¨‹) -->
    <nav class="w-full h-16 border-b border-gray-800 bg-black/80 backdrop-blur-md flex items-center justify-between px-6 z-50 shrink-0">
        <div class="flex items-center gap-2 cursor-pointer" onclick="switchTab('home')">
            <div class="w-8 h-8 bg-gradient-to-br from-emerald-500 to-blue-600 rounded-lg flex items-center justify-center text-black font-bold"><i class="fas fa-bolt"></i></div>
            <span class="font-bold text-xl tracking-tight text-white">OddsFlow<span class="text-emerald-500">.ai</span></span>
        </div>
        <div class="hidden md:flex items-center gap-6 text-sm font-medium text-gray-400">
            <button onclick="switchTab('home')" class="hover:text-white transition nav-btn" data-target="home">é¦–é¡µ</button>
            <button onclick="switchTab('dashboard')" class="hover:text-white transition nav-btn" data-target="dashboard">å®æ—¶ç»ˆç«¯</button>
            <!-- ğŸ”¥ æ–°å¢æŒ‰é’® -->
            <button onclick="switchTab('epl')" class="hover:text-white transition nav-btn text-purple-400" data-target="epl">
                <i class="fas fa-shield-alt mr-1"></i>è‹±è¶…èµ›ç¨‹
            </button>
            <button onclick="switchTab('guide')" class="hover:text-white transition nav-btn" data-target="guide">æ•™ç¨‹</button>
            <button onclick="switchTab('pricing')" class="hover:text-white transition nav-btn" data-target="pricing">ä»·æ ¼</button>
        </div>
        <div class="flex items-center gap-4">
            <button onclick="toggleLanguage()" class="text-xs font-bold border border-gray-700 rounded px-2 py-1 hover:bg-gray-800 transition"><span id="lang-display">EN / <span class="text-emerald-500">CN</span></span></button>
            <a href="https://t.me/footballscbet_bot" target="_blank" class="bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-full font-bold text-xs transition shadow-lg shadow-emerald-500/20 flex items-center gap-2"><i class="fab fa-telegram-plane"></i> åŠ å…¥ç”µæŠ¥ç¾¤</a>
        </div>
    </nav>

    <!-- ä¸»å†…å®¹ -->
    <main class="flex-1 overflow-y-auto p-4 pb-20" id="main-content">
        
        <!-- é¦–é¡µ -->
        <section id="home" class="page-section active min-h-full">
            <div class="max-w-7xl mx-auto px-6 py-20 text-center">
                <div class="inline-block px-4 py-1.5 rounded-full bg-emerald-900/30 border border-emerald-500/30 text-emerald-400 text-xs font-bold mb-8">ğŸš€ å…¨ç½‘é¦–ä¸ª AI é©±åŠ¨çš„è¶³çƒäº¤æ˜“æ‰«æä»ª</div>
                <h1 class="text-5xl md:text-7xl font-black mb-6 leading-tight">åˆ«å†ç›²ç›®å…¥åœºã€‚<br><span class="text-gradient">å¼€å§‹åƒä¸“å®¶ä¸€æ ·äº¤æ˜“ã€‚</span></h1>
                <p class="text-xl text-gray-400 max-w-2xl mx-auto mb-10">OddsFlow å®æ—¶ç›‘æ§å…¨çƒ 500+ åœºæ¯”èµ›ã€‚å½“å‹åŠ›æŒ‡æ•°çˆ†è¡¨æˆ–èµ”ç‡å‡ºç°æ¼æ´æ—¶ï¼ŒAI ä¼šåœ¨è¿›çƒå‘ç”Ÿå‰ 2 åˆ†é’Ÿé€šçŸ¥ä½ ã€‚</p>
                <div class="flex justify-center gap-4">
                    <button onclick="switchTab('dashboard')" class="px-8 py-4 bg-white text-black font-bold rounded-xl hover:bg-gray-200 transition shadow-xl">è¿›å…¥æ¼”ç¤ºç»ˆç«¯</button>
                    <!-- ğŸ”¥ å¼•å¯¼å»è‹±è¶…é¡µ -->
                    <button onclick="switchTab('epl')" class="px-8 py-4 bg-purple-900/50 text-white border border-purple-500/50 rounded-xl hover:bg-purple-800 transition font-bold">
                        æŸ¥çœ‹è‹±è¶…æ•°æ®
                    </button>
                </div>
            </div>
        </section>

        <!-- å®æ—¶ç»ˆç«¯ (Dashboard) -->
        <section id="dashboard" class="page-section">
            <div class="text-center py-8">
                <h1 class="text-2xl font-bold mb-2">å®æ—¶ç›‘æ§ç»ˆç«¯ (Live)</h1>
                <p class="text-xs text-gray-500">ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹æ·±åº¦åˆ†æ</p>
            </div>
            <div class="max-w-3xl mx-auto space-y-4" id="match-container">
                <div class="text-center py-10 text-gray-500 animate-pulse">æ­£åœ¨è¿æ¥ AI å«æ˜Ÿä¿¡å·...</div>
            </div>
        </section>

        <!-- ğŸ”¥ æ–°å¢ï¼šè‹±è¶…å‰ç» (EPL Upcoming) -->
        <section id="epl" class="page-section">
            <div class="text-center py-8">
                <h1 class="text-2xl font-bold mb-2 text-purple-400">è‹±è¶…èµ›äº‹å‰ç»</h1>
                <p class="text-xs text-gray-500">Upcoming Premier League Fixtures</p>
            </div>
            <div class="max-w-3xl mx-auto grid gap-4" id="epl-container">
                <div class="text-center py-10 text-gray-500 animate-pulse">æ­£åœ¨åŠ è½½è‹±è¶…èµ›ç¨‹...</div>
            </div>
        </section>

        <!-- æ•™ç¨‹ & ä»·æ ¼ (ä¿æŒç²¾ç®€) -->
        <section id="guide" class="page-section">
            <div class="max-w-4xl mx-auto px-6 py-12 text-center">
                <h1 class="text-3xl font-bold mb-8">å¦‚ä½•è·åˆ©ï¼Ÿ</h1>
                <p class="text-gray-400">å…³æ³¨å‹åŠ›æ¡ > 80% çš„æ¯”èµ›ï¼Œç»“åˆ AI å»ºè®®å…¥åœºã€‚</p>
            </div>
        </section>
        
        <section id="pricing" class="page-section">
            <div class="max-w-4xl mx-auto px-6 py-12 text-center">
                <h1 class="text-3xl font-bold mb-8">è®¢é˜…ä»·æ ¼</h1>
                <div class="bg-gradient-to-b from-gray-800 to-black border border-emerald-500 p-8 rounded-3xl max-w-sm mx-auto">
                    <h3 class="text-xl font-bold text-emerald-400 mb-2">PRO æ“ç›˜æ‰‹</h3>
                    <div class="text-5xl font-bold text-white mb-2">RM 68<span class="text-lg text-gray-500">/æœˆ</span></div>
                    <a href="https://t.me/footballscbet_bot" target="_blank" class="block w-full py-4 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold mt-6">ç«‹å³è®¢é˜…</a>
                </div>
            </div>
        </section>

    </main>

    <!-- å¼¹çª— -->
    <div id="match-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="absolute inset-x-0 bottom-0 md:inset-0 md:flex md:items-center md:justify-center pointer-events-none">
            <div class="bg-[#0f0f0f] md:rounded-2xl md:max-w-2xl w-full p-6 border border-gray-800 shadow-2xl pointer-events-auto" id="modal-panel">
                <div id="modal-content"></div>
                <button onclick="closeModal()" class="mt-6 w-full bg-gray-800 text-white py-3 rounded-xl">å…³é—­</button>
            </div>
        </div>
    </div>

    <script>
        // --- é…ç½® ---
        const SUPABASE_URL = 'https://ncubbsgzebbmoqslyukd.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_sVNMF9y0NlYxSqjqKqwySw_b1DJyEdg';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        
        let matchesData = [];
        const adsData = [
            { type: "ad", content: { brand: "ğŸ‘‘ å®˜æ–¹æ¨è: GSlot16", title: "å…¨ç½‘æœ€ç¨³è€è™æœº/çœŸäººè§†è®¯å¹³å°", desc: "å¤§é¢æ— å¿§ï¼Œç§’å……ç§’æã€‚OddsFlow ç”¨æˆ·ä¸“äº«çº¢åˆ©ã€‚", btn_text: "è¿›å…¥ GSlot16 å®˜ç½‘", link: "https://gslot16.com?ag=RS-c2VzYW1lcmFiYml0" } },
            { type: "ad", content: { brand: "âš½ BK8 äºšæ´²ç¬¬ä¸€ä½“è‚²", title: "OddsFlow ç‹¬å®¶åˆä½œä¼™ä¼´", desc: "è‹±è¶…å®˜æ–¹èµåŠ©å•†ã€‚ä½“è‚²èµ›äº‹èµ”ç‡æœ€é«˜ã€‚", btn_text: "é¢†å– BK8 çº¢åˆ©", link: "https://www.bk8.com/" } }
        ];

        // --- æ ¸å¿ƒé€»è¾‘ ---
        
        // 1. æŠ“å–å®æ—¶æ¯”èµ› (Live)
        async function fetchLiveMatches() {
            const container = document.getElementById('match-container');
            try {
                const { data, error } = await supabase.from('live_signals').select('*').order('created_at', { ascending: false }).limit(20);
                if(error) throw error;
                
                matchesData = [];
                if(data && data.length > 0) {
                    data.forEach((m, i) => {
                        matchesData.push({ type: 'match', result: m });
                        if(i===0) matchesData.push(adsData[0]);
                        if(i===2) matchesData.push(adsData[1]);
                    });
                    renderLiveList();
                } else {
                    container.innerHTML = '<div class="text-center text-gray-500 py-10">æš‚æ— å®æ—¶é«˜å‹æ¯”èµ›...</div>';
                }
            } catch(e) { console.error(e); container.innerHTML = '<div class="text-center text-gray-500">è¿æ¥å¤±è´¥</div>'; }
        }

        // 2. æŠ“å–è‹±è¶…èµ›ç¨‹ (EPL Upcoming) - ğŸ”¥ æ–°å¢å‡½æ•°
        async function fetchEPL() {
            const container = document.getElementById('epl-container');
            // æš‚æ—¶ç”¨ Mock æ•°æ®æ¼”ç¤ºï¼Œç­‰ä½  N8N è·‘é€š Supabase åï¼Œè§£å¼€ä¸‹é¢çš„æ³¨é‡Š
            /*
            const { data, error } = await supabase.from('upcoming_epl').select('*').order('start_date', { ascending: true });
            if (data) renderEPL(data);
            */
           
            // ğŸ‘‡ æ¨¡æ‹Ÿæ•ˆæœ (ç”¨ä½ åˆšæ‰ç»™çš„ JSON ç»“æ„)
            // å½“ä½  N8N å­˜å¥½æ•°æ®åï¼Œè¿™æ®µå¯ä»¥åˆ æ‰ï¼Œæ”¹ç”¨ä¸Šé¢çš„çœŸå®è¯»å–
            const mockEPL = [
                {
                    start_date: "2025-11-22T12:30:00Z",
                    home_team: "Burnley FC",
                    away_team: "Chelsea FC",
                    home_logo: "https://cdn.opticodds.com/team-logos/soccer/3763.png",
                    away_logo: "https://cdn.opticodds.com/team-logos/soccer/4009.png",
                    venue: "Turf Moor"
                },
                {
                    start_date: "2025-11-22T15:00:00Z",
                    home_team: "Arsenal",
                    away_team: "Nottm Forest",
                    home_logo: "https://cdn.opticodds.com/team-logos/soccer/3766.png",
                    away_logo: "https://cdn.opticodds.com/team-logos/soccer/3917.png",
                    venue: "Emirates Stadium"
                }
            ];
            renderEPL(mockEPL);
        }

        // --- è‹±è¶…ä¸“å±æ¸²æŸ“é€»è¾‘ (v9.1 è§†è§‰å¢å¼ºç‰ˆ) ---

        // 1. æ¸²æŸ“åˆ—è¡¨ (å¡ç‰‡)
        function renderEPL(data) {
            const container = document.getElementById('epl-container');
            let html = '';
            
            data.forEach((m, index) => {
                // æ—¶é—´æ ¼å¼åŒ–
                const date = new Date(m.start_date);
                const timeStr = date.toLocaleString('zh-CN', { month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' });

                // å°†æ•°æ®å­˜å…¥å…¨å±€å˜é‡ï¼Œæ–¹ä¾¿å¼¹çª—è°ƒç”¨
                // æ³¨æ„ï¼šè¿™é‡Œå‡è®¾ N8N å·²ç»æŠŠ win_prob ç­‰æ•°æ®å­˜è¿›å»äº†
                // å¦‚æœè¿˜æ²¡å­˜ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºé»˜è®¤å€¼
                
                html += `
                <div onclick="openEPLModal(${index})" class="bg-[#1a1a1a] p-6 rounded-xl border border-purple-900/30 relative overflow-hidden cursor-pointer hover:border-purple-500 transition group">
                    <div class="absolute top-0 left-0 bg-purple-600 text-white text-[10px] px-2 py-1 rounded-br-lg">PREMIER LEAGUE</div>
                    <div class="absolute top-2 right-2 text-gray-600 group-hover:text-purple-400"><i class="fas fa-chart-bar"></i> åˆ†æ</div>
                    
                    <div class="text-center text-xs text-gray-500 mb-4">${timeStr} â€¢ ${m.venue}</div>
                    
                    <div class="flex justify-between items-center">
                        <div class="text-center w-1/3">
                            <img src="${m.home_logo}" class="w-12 h-12 mx-auto mb-2 drop-shadow-lg" alt="Home">
                            <div class="font-bold text-white text-sm">${m.home_team}</div>
                        </div>
                        <div class="text-2xl font-bold text-gray-700 font-mono">VS</div>
                        <div class="text-center w-1/3">
                            <img src="${m.away_logo}" class="w-12 h-12 mx-auto mb-2 drop-shadow-lg" alt="Away">
                            <div class="font-bold text-white text-sm">${m.away_team}</div>
                        </div>
                    </div>
                </div>`;
            });
            container.innerHTML = html;
            
            // æŠŠæ•°æ®å­˜åˆ° window å¯¹è±¡ï¼Œç»™å¼¹çª—ç”¨
            window.eplData = data;
        }

        // 2. æ‰“å¼€è‹±è¶…è¯¦æƒ…å¼¹çª— (æ ¸å¿ƒï¼šç”»èƒœç‡æ¡å’Œç§¯åˆ†æ¦œ)
        function openEPLModal(index) {
            const m = window.eplData[index];
            
            // --- æ¨¡æ‹Ÿæ•°æ® (å¦‚æœä½ æ•°æ®åº“è¿˜æ²¡è¿™ä¸¤ä¸ªå­—æ®µï¼Œç”¨è¿™ä¸ªå…œåº•ï¼Œé˜²æ­¢æŠ¥é”™) ---
            const prob = {
                home: m.win_prob_home || 14, // ä¼¯æ©åˆ©
                draw: m.win_prob_draw || 21,
                away: m.win_prob_away || 65  // åˆ‡å°”è¥¿
            };
            
            // æ¨¡æ‹Ÿç§¯åˆ†æ¦œ (çœŸå®æƒ…å†µæ˜¯ä» m.standings_json è¯»å–)
            // è¿™é‡Œä¸ºäº†æ¼”ç¤ºæ•ˆæœï¼Œæˆ‘å†™æ­»äº†ä½ æˆªå›¾é‡Œçš„æ•°æ®
            const standings = m.standings_json || [
                { rank: 1, team: "Arsenal", p: 26, form: "WWWWD" },
                { rank: 2, team: "Man City", p: 22, form: "WWLWW" },
                { rank: 3, team: "Chelsea", p: 20, form: "WWLWW" },
                { rank: 4, team: "Sunderland", p: 19, form: "LWWDD" }
            ];

            // --- ç”Ÿæˆ HTML ---
            const content = `
                <!-- 1. å¯¹é˜µå¤´éƒ¨ -->
                <div class="flex justify-between items-center mb-8 px-4">
                    <div class="text-center">
                        <img src="${m.home_logo}" class="w-16 h-16 mx-auto mb-2">
                        <h3 class="text-lg font-bold text-white">${m.home_team}</h3>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-500 uppercase tracking-widest">Win Probability</div>
                        <div class="text-3xl font-black text-white italic">VS</div>
                    </div>
                    <div class="text-center">
                        <img src="${m.away_logo}" class="w-16 h-16 mx-auto mb-2">
                        <h3 class="text-lg font-bold text-white">${m.away_team}</h3>
                    </div>
                </div>

                <!-- 2. èƒœç‡è¿›åº¦æ¡ (Win Probability) -->
                <div class="mb-8 bg-gray-900 p-4 rounded-xl border border-gray-800">
                    <div class="flex justify-between text-xs text-gray-400 mb-2">
                        <span class="text-red-500 font-bold">${m.home_team} ${prob.home}%</span>
                        <span>Draw ${prob.draw}%</span>
                        <span class="text-blue-500 font-bold">${m.away_team} ${prob.away}%</span>
                    </div>
                    <div class="flex h-3 rounded-full overflow-hidden">
                        <div style="width: ${prob.home}%" class="bg-red-600 h-full"></div>
                        <div style="width: ${prob.draw}%" class="bg-gray-600 h-full"></div>
                        <div style="width: ${prob.away}%" class="bg-blue-600 h-full"></div>
                    </div>
                </div>

                <!-- 3. ç§¯åˆ†æ¦œ (Standings) -->
                <div class="mb-4">
                    <h4 class="text-white font-bold text-sm mb-3 border-l-2 border-purple-500 pl-2">LIVE STANDINGS</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs text-left text-gray-400">
                            <thead class="text-xs text-gray-500 uppercase bg-gray-800/50">
                                <tr>
                                    <th class="px-2 py-2">#</th>
                                    <th class="px-2 py-2">Team</th>
                                    <th class="px-2 py-2">Pts</th>
                                    <th class="px-2 py-2">Form</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-800">
                                ${standings.map(row => `
                                <tr class="${row.team === m.home_team || row.team === m.away_team ? 'bg-white/5' : ''}">
                                    <td class="px-2 py-3 font-mono">${row.rank}</td>
                                    <td class="px-2 py-3 font-bold text-white flex items-center gap-2">
                                        ${row.team}
                                    </td>
                                    <td class="px-2 py-3 font-bold text-white">${row.p}</td>
                                    <td class="px-2 py-3">
                                        <div class="flex gap-1">
                                            ${row.form.split('').map(r => 
                                                `<span class="w-4 h-4 flex items-center justify-center rounded-full text-[8px] text-white ${r==='W'?'bg-green-500':(r==='L'?'bg-red-500':'bg-gray-500')}">${r}</span>`
                                            ).join('')}
                                        </div>
                                    </td>
                                </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

            // æ³¨å…¥å¹¶æ˜¾ç¤º
            document.getElementById('modal-content').innerHTML = content;
            const modal = document.getElementById('match-modal');
            const panel = document.getElementById('modal-panel');
            modal.classList.remove('hidden');
            setTimeout(() => panel.classList.remove('translate-y-full'), 10);
        }
