<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OddsFlow AI - æ™ºèƒ½è¶³çƒäº¤æ˜“ç»ˆç«¯</title>
    <meta name="description" content="OddsFlow AI - å®æ—¶è¶³çƒèµ”ç‡ç›‘æ§ä¸è‹±è¶…å¤§æ•°æ®åˆ†æã€‚">
    
    <!-- æ ¸å¿ƒ SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* 1. å¸ƒå±€ä¸èƒŒæ™¯æ ¸å¿ƒ (ä¿®å¤é»‘å±é—®é¢˜) */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0; padding: 0;
            background-color: #000;
            color: white;
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        /* ç”µå½±çº§èƒŒæ™¯ - æ”¾åœ¨æœ€åº•å±‚ z-index: -2 */
        #hero-bg {
            position: fixed; inset: 0; z-index: -2;
            background: url('https://images.unsplash.com/photo-1518091043644-c1d4457512c6?q=80&w=2831&auto=format&fit=crop') no-repeat center center/cover;
            opacity: 0.6; /* æé«˜äº®åº¦ */
            animation: kenburns 30s infinite alternate;
        }
        @keyframes kenburns { 0% { transform: scale(1); } 100% { transform: scale(1.1); } }

        /* å…¨æ¯ç½‘æ ¼ & æš—è§’ - z-index: -1 */
        #grid-overlay {
            position: fixed; inset: 0; z-index: -1;
            background-image: 
                linear-gradient(rgba(16, 185, 129, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(16, 185, 129, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
            background-color: rgba(0,0,0,0.7); /* é»‘è‰²é®ç½© */
            mask-image: radial-gradient(circle at center, transparent 10%, black 100%); /* æš—è§’ */
        }

        /* 2. ç»ç’ƒæ‹Ÿæ€ UI */
        .bg-glass {
            background: rgba(20, 20, 20, 0.75);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }
        
        .sidebar {
            width: 260px;
            background: rgba(5, 5, 5, 0.95);
            border-right: 1px solid rgba(255,255,255,0.05);
            display: flex; flex-direction: column;
            z-index: 50;
        }

        .main-content {
            flex: 1;
            overflow-y: auto;
            position: relative;
            z-index: 10; /* ç¡®ä¿å†…å®¹åœ¨èƒŒæ™¯ä¹‹ä¸Š */
        }

        /* 3. åŠ¨ç”» */
        .live-dot { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); } }
        
        .ticker-wrap { overflow: hidden; white-space: nowrap; background: rgba(0,0,0,0.9); border-bottom: 1px solid rgba(255,255,255,0.1); height: 32px; display: flex; align-items: center; z-index: 40; }
        .ticker-content { display: inline-block; animation: scroll 40s linear infinite; }
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        .page-section { display: none; padding: 2rem; }
        .page-section.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* 4. å·¥å…·ç±» */
        .input-dark { @apply w-full bg-black border border-gray-700 rounded p-2 text-white text-sm font-mono focus:border-emerald-500 focus:outline-none; }
        .tab-btn.active { @apply bg-emerald-600 text-white border-emerald-500; }
        .tab-btn { @apply bg-gray-800 text-gray-400 border border-gray-700 hover:text-white; }
    </style>
</head>
<body>

    <!-- èƒŒæ™¯å±‚ -->
    <div id="hero-bg"></div>
    <div id="grid-overlay"></div>

    <!-- å·¦ä¾§è¾¹æ  -->
    <aside class="sidebar hidden md:flex">
        <div class="h-16 flex items-center px-6 border-b border-white/10">
            <div class="w-8 h-8 bg-gradient-to-br from-emerald-500 to-emerald-700 rounded flex items-center justify-center mr-3 shadow-[0_0_15px_rgba(16,185,129,0.4)]">
                <i class="fas fa-bolt text-white"></i>
            </div>
            <span class="font-bold text-lg tracking-tight">OddsFlow</span>
        </div>
        
        <nav class="flex-1 p-4 space-y-1">
            <div class="text-[10px] text-gray-500 font-bold uppercase px-3 mt-4 mb-2">Menu</div>
            <button onclick="switchTab('home')" class="nav-btn w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white transition">
                <i class="fas fa-home w-6 text-center"></i> <span data-i18n="menu_home">é¦–é¡µ</span>
            </button>
            <button onclick="switchTab('dashboard')" class="nav-btn w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white transition">
                <i class="fas fa-chart-line w-6 text-center text-emerald-400"></i> <span data-i18n="menu_terminal">å®æ—¶ç»ˆç«¯</span>
            </button>
            <button onclick="switchTab('epl')" class="nav-btn w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white transition">
                <i class="fas fa-shield-alt w-6 text-center text-purple-400"></i> <span data-i18n="menu_epl">è‹±è¶…å‰ç»</span>
            </button>
            
            <div class="text-[10px] text-gray-500 font-bold uppercase px-3 mt-6 mb-2">Tools</div>
            <button onclick="openCalcModal('kelly')" class="w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white transition">
                <i class="fas fa-calculator w-6 text-center"></i> <span data-i18n="menu_calc">äº¤æ˜“è®¡ç®—å™¨</span>
            </button>
            <button onclick="switchTab('guide')" class="nav-btn w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white transition">
                <i class="fas fa-book w-6 text-center"></i> <span data-i18n="menu_guide">æ•™ç¨‹</span>
            </button>
        </nav>

        <div class="p-4 border-t border-white/10">
            <a href="https://t.me/footballscbet_bot" target="_blank" class="flex items-center gap-3 p-3 rounded-xl bg-emerald-900/20 border border-emerald-500/20 hover:bg-emerald-900/40 transition">
                <div class="w-8 h-8 rounded-full bg-emerald-600 flex items-center justify-center text-white"><i class="fas fa-crown"></i></div>
                <div>
                    <div class="text-xs font-bold text-white">PRO Access</div>
                    <div class="text-[10px] text-gray-400">Upgrade Now</div>
                </div>
            </a>
        </div>
    </aside>

    <!-- å³ä¾§ä¸»å†…å®¹ -->
    <main class="main-content">
        
        <!-- ç§»åŠ¨ç«¯ Header -->
        <div class="md:hidden h-14 bg-black/90 border-b border-white/10 flex items-center justify-between px-4 sticky top-0 z-50 backdrop-blur">
            <div class="font-bold flex items-center gap-2 text-white"><i class="fas fa-bolt text-emerald-500"></i> OddsFlow</div>
            <button onclick="document.querySelector('aside').classList.toggle('hidden'); document.querySelector('aside').classList.toggle('fixed'); document.querySelector('aside').classList.toggle('h-full');" class="text-gray-300"><i class="fas fa-bars text-xl"></i></button>
        </div>

        <!-- é¡¶éƒ¨æ¡ -->
        <div class="ticker-wrap">
            <div class="ticker-content text-[10px] font-mono flex gap-10 text-emerald-400">
                <span>âš¡ SYSTEM ONLINE</span>
                <span>ğŸ“¡ SCANNING: 532 MATCHES</span>
                <span>ğŸ’° VALUE: Real Madrid (1.85)</span>
                <span>ğŸš¨ ALERT: Heavy Load on Asian Market</span>
                <span>âš¡ SYSTEM ONLINE</span>
                <span>ğŸ“¡ SCANNING: 532 MATCHES</span>
            </div>
        </div>

        <div class="h-16 px-6 flex items-center justify-between border-b border-white/10 bg-black/20 backdrop-blur-md">
            <div class="text-xs text-gray-300 flex items-center gap-2">
                <span class="w-2 h-2 bg-emerald-500 rounded-full live-dot"></span> <span data-i18n="status_online">System Operational</span>
            </div>
            <div class="flex items-center gap-4">
                <!-- è¯­è¨€åˆ‡æ¢ (Hover Dropdown) -->
                <div class="relative group">
                    <button class="flex items-center gap-2 text-xs font-bold text-gray-300 hover:text-white px-3 py-1.5 rounded-lg border border-white/10 bg-white/5">
                        <i class="fas fa-globe"></i> <span id="current-lang">CN</span>
                    </button>
                    <div class="hidden group-hover:block absolute right-0 top-full mt-0 w-32 bg-black border border-white/20 rounded-xl shadow-2xl overflow-hidden z-50">
                        <a onclick="setLang('zh')" class="block px-4 py-2 text-xs text-gray-400 hover:bg-emerald-900 hover:text-white cursor-pointer">ä¸­æ–‡ (CN)</a>
                        <a onclick="setLang('en')" class="block px-4 py-2 text-xs text-gray-400 hover:bg-emerald-900 hover:text-white cursor-pointer">English (EN)</a>
                        <a onclick="setLang('es')" class="block px-4 py-2 text-xs text-gray-400 hover:bg-emerald-900 hover:text-white cursor-pointer">EspaÃ±ol (ES)</a>
                        <a onclick="setLang('pt')" class="block px-4 py-2 text-xs text-gray-400 hover:bg-emerald-900 hover:text-white cursor-pointer">PortuguÃªs (PT)</a>
                        <a onclick="setLang('id')" class="block px-4 py-2 text-xs text-gray-400 hover:bg-emerald-900 hover:text-white cursor-pointer">Indonesia (ID)</a>
                        <a onclick="setLang('ms')" class="block px-4 py-2 text-xs text-gray-400 hover:bg-emerald-900 hover:text-white cursor-pointer">Melayu (MS)</a>
                    </div>
                </div>

                <a href="https://gslot16.com?ag=RS-c2VzYW1lcmFiYml0" target="_blank" class="bg-emerald-600 hover:bg-emerald-500 text-white text-xs px-4 py-2 rounded-full font-bold shadow-lg shadow-emerald-500/20 transition flex items-center gap-2">
                    <div class="w-2 h-2 bg-white rounded-full animate-ping"></div>
                    <span data-i18n="btn_connect">è¿æ¥äº¤æ˜“è´¦æˆ·</span>
                </a>
            </div>
        </div>

        <!-- ================= HOME ================= -->
        <section id="home" class="page-section active">
            <div class="max-w-6xl mx-auto pt-10 flex flex-col lg:flex-row items-center gap-16">
                <div class="flex-1 text-center lg:text-left">
                    <div class="inline-block px-3 py-1 rounded-full bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 text-[10px] font-bold mb-6 backdrop-blur">
                        <i class="fas fa-code-branch"></i> v16.0 STABLE
                    </div>
                    
                    <!-- éœ‡æ’¼å¤§æ ‡é¢˜ -->
                    <h1 class="text-6xl lg:text-8xl font-black text-white mb-6 tracking-tighter leading-tight drop-shadow-2xl">
                        <span data-i18n="hero_h1_1">æ•°æ®é©±åŠ¨</span><br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 via-cyan-300 to-blue-500" data-i18n="hero_h1_2">ç²¾å‡†è·åˆ©ã€‚</span>
                    </h1>
                    
                    <p class="text-lg text-gray-300 mb-10 max-w-xl mx-auto lg:mx-0 leading-relaxed" data-i18n="hero_sub">
                        æ‹’ç»ç›²èµŒã€‚æˆ‘ä»¬ä½¿ç”¨ N8N è‡ªåŠ¨åŒ–ä¸ Supabase å¤§æ•°æ®ï¼Œä¸ºæ‚¨æ•æ‰åº„å®¶æ¼æ´ã€‚
                    </p>
                    
                    <div class="flex gap-4 justify-center lg:justify-start">
                        <button onclick="switchTab('dashboard')" class="bg-white text-black px-8 py-3 rounded-xl font-bold hover:bg-emerald-400 transition shadow-[0_0_30px_rgba(255,255,255,0.2)] flex items-center gap-2">
                            <i class="fas fa-rocket"></i> <span data-i18n="btn_start">å¯åŠ¨ç›‘æ§</span>
                        </button>
                        <button onclick="openCalcModal('kelly')" class="bg-white/10 border border-white/20 text-white px-8 py-3 rounded-xl font-bold hover:bg-white/20 transition backdrop-blur-md">
                            <i class="fas fa-calculator mr-2"></i> <span data-i18n="btn_calc">è®¡ç®—å™¨</span>
                        </button>
                    </div>
                </div>
                
                <!-- æ¨¡æ‹Ÿç»ˆç«¯ (CSS Draw) -->
                <div class="flex-1 w-full max-w-md transform hover:scale-105 transition duration-500 relative">
                    <div class="bg-[#0F1115] border border-gray-700 rounded-xl shadow-2xl overflow-hidden relative z-10">
                        <div class="h-8 bg-[#161b22] border-b border-gray-700 flex items-center px-3 gap-2">
                            <div class="w-2.5 h-2.5 rounded-full bg-red-500"></div><div class="w-2.5 h-2.5 rounded-full bg-yellow-500"></div><div class="w-2.5 h-2.5 rounded-full bg-green-500"></div>
                        </div>
                        <div class="p-6">
                            <div class="flex justify-between text-xs font-mono text-gray-400 mb-4">
                                <span>TARGET: MAN CITY</span><span class="text-emerald-500 animate-pulse">â— MONITORING</span>
                            </div>
                            <div class="h-32 border-b border-gray-800 mb-4 relative flex items-end pb-2 gap-1">
                                <!-- åŠ¨æ€æ³¢å½¢ -->
                                <div class="w-1/6 h-[30%] bg-emerald-900/50 rounded-t"></div>
                                <div class="w-1/6 h-[50%] bg-emerald-800/50 rounded-t"></div>
                                <div class="w-1/6 h-[40%] bg-emerald-700/50 rounded-t"></div>
                                <div class="w-1/6 h-[70%] bg-emerald-600/50 rounded-t"></div>
                                <div class="w-1/6 h-[60%] bg-emerald-500/50 rounded-t"></div>
                                <div class="w-1/6 h-[90%] bg-emerald-400 rounded-t shadow-[0_0_10px_#34d399]"></div>
                                <div class="absolute top-4 right-0 bg-red-500/20 text-red-400 text-[10px] px-2 py-1 rounded border border-red-500/50">âš ï¸ PRESSURE: 92%</div>
                            </div>
                            <div class="space-y-2 text-xs font-mono">
                                <div class="flex justify-between text-gray-400"><span>xG (Expected)</span><span class="text-white">2.45</span></div>
                                <div class="text-emerald-400">> AI Recommendation: Over 2.5 Goals</div>
                            </div>
                        </div>
                    </div>
                    <!-- èƒŒåå…‰æ•ˆ -->
                    <div class="absolute -z-10 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[110%] h-[110%] bg-emerald-500/10 blur-[60px]"></div>
                </div>
            </div>
        </section>

        <!-- ================= DASHBOARD ================= -->
        <section id="dashboard" class="page-section">
            <div class="text-center mb-10">
                <h2 class="text-2xl font-bold text-white mb-2" data-i18n="dash_title">å®æ—¶ç›‘æ§ç»ˆç«¯</h2>
                <p class="text-xs text-gray-400">Live Feed via Supabase Cloud</p>
            </div>
            <div class="max-w-3xl mx-auto space-y-4" id="match-container">
                <!-- é»˜è®¤åŠ è½½éª¨æ¶å± -->
                <div class="animate-pulse space-y-4">
                    <div class="h-24 bg-gray-800/50 rounded-xl"></div>
                    <div class="h-24 bg-gray-800/50 rounded-xl"></div>
                </div>
            </div>
        </section>

        <!-- ================= EPL ================= -->
        <section id="epl" class="page-section">
            <div class="text-center mb-10">
                <h2 class="text-2xl font-bold text-purple-400" data-i18n="epl_title">è‹±è¶…èµ›äº‹å‰ç»</h2>
            </div>
            <div class="max-w-3xl mx-auto grid md:grid-cols-2 gap-4" id="epl-container"></div>
        </section>

        <!-- ================= GUIDE & PRICE ================= -->
        <section id="guide" class="page-section">
             <div class="max-w-4xl mx-auto px-6 py-12 text-center text-gray-400">
                <h1 class="text-2xl text-white font-bold mb-4">å¦‚ä½•è·åˆ©ï¼Ÿ</h1>
                <p>å…³æ³¨å‹åŠ›æ¡ > 80% çš„æ¯”èµ›ï¼Œç»“åˆ AI å»ºè®®å…¥åœºã€‚</p>
             </div>
        </section>
        
        <section id="pricing" class="page-section">
            <div class="max-w-sm mx-auto bg-glass p-8 rounded-2xl border border-emerald-500 text-center">
                <h3 class="text-emerald-400 font-bold mb-2">PRO TRADER</h3>
                <div class="text-5xl font-bold text-white mb-4">RM 68<span class="text-lg text-gray-500">/mo</span></div>
                <a href="https://t.me/footballscbet_bot" target="_blank" class="block w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500">ç«‹å³è®¢é˜…</a>
            </div>
        </section>
    </main>

    <!-- ğŸ”¥ 3åˆ1 é«˜çº§è®¡ç®—å™¨æ¨¡æ€æ¡† -->
    <div id="calc-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm" onclick="document.getElementById('calc-modal').classList.add('hidden')"></div>
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
            <div class="bg-[#1a1a1a] rounded-2xl w-[400px] border border-gray-700 pointer-events-auto shadow-2xl overflow-hidden">
                <!-- é¡¶éƒ¨ Tab -->
                <div class="flex border-b border-gray-700 bg-[#111]">
                    <button onclick="switchCalc('kelly')" class="calc-tab flex-1 py-3 text-xs font-bold text-white bg-gray-800 border-b-2 border-emerald-500">Kelly</button>
                    <button onclick="switchCalc('arb')" class="calc-tab flex-1 py-3 text-xs font-bold text-gray-500 hover:text-white">Arbitrage</button>
                    <button onclick="switchCalc('novig')" class="calc-tab flex-1 py-3 text-xs font-bold text-gray-500 hover:text-white">No-Vig</button>
                </div>

                <div class="p-6">
                    <!-- 1. å‡¯åˆ©å…¬å¼ -->
                    <div id="tab-kelly" class="calc-content">
                        <h3 class="text-white font-bold mb-4 text-center">å‡¯åˆ©ä»“ä½ç®¡ç†</h3>
                        <div class="space-y-4 text-xs">
                            <div><label class="text-gray-500 block mb-1">Win % (èƒœç‡)</label><input type="range" id="k-win" min="1" max="99" value="55" class="w-full accent-emerald-500 h-2 bg-gray-700 rounded-lg appearance-none"><div class="text-right text-emerald-400 font-bold mt-1" id="k-win-val">55%</div></div>
                            <div><label class="text-gray-500 block mb-1">Odds (èµ”ç‡)</label><input type="number" id="k-odds" value="2.00" class="input-dark" oninput="runKelly()"></div>
                            <div><label class="text-gray-500 block mb-1">Bankroll (æœ¬é‡‘)</label><input type="number" id="k-bank" value="1000" class="input-dark" oninput="runKelly()"></div>
                            <div class="bg-black/50 p-3 rounded border border-gray-700 text-center mt-4">
                                <div class="text-gray-500">å»ºè®®ä¸‹æ³¨</div>
                                <div id="k-res" class="text-2xl font-mono font-bold text-white">$100</div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. å¥—åˆ©è®¡ç®—å™¨ -->
                    <div id="tab-arb" class="calc-content hidden">
                        <h3 class="text-white font-bold mb-4 text-center">æ— é£é™©å¥—åˆ©è®¡ç®—</h3>
                        <div class="space-y-3 text-xs">
                            <div class="grid grid-cols-2 gap-2">
                                <div><label class="text-blue-400 block mb-1">Odds A</label><input type="number" id="arb-o1" value="2.10" class="input-dark" oninput="runArb()"></div>
                                <div><label class="text-red-400 block mb-1">Odds B</label><input type="number" id="arb-o2" value="2.05" class="input-dark" oninput="runArb()"></div>
                            </div>
                            <div><label class="text-gray-500 block mb-1">Total Stake</label><input type="number" id="arb-stake" value="1000" class="input-dark" oninput="runArb()"></div>
                            <div class="text-center py-2" id="arb-profit-pct">Profit: <span class="text-emerald-400">3.73%</span></div>
                            <div class="bg-black/50 p-3 rounded border border-gray-700 font-mono text-[10px]">
                                <div class="flex justify-between mb-1"><span>Bet A:</span><span class="text-white" id="arb-s1">$493.98</span></div>
                                <div class="flex justify-between"><span>Bet B:</span><span class="text-white" id="arb-s2">$506.02</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. å»æ°´è®¡ç®—å™¨ -->
                    <div id="tab-novig" class="calc-content hidden">
                        <h3 class="text-white font-bold mb-4 text-center">çœŸå®æ¦‚ç‡ (å»æ°´)</h3>
                        <div class="space-y-4 text-xs">
                            <div class="grid grid-cols-2 gap-2">
                                <input type="number" id="vig-o1" value="1.90" class="input-dark text-center" placeholder="Home" oninput="runVig()">
                                <input type="number" id="vig-o2" value="1.90" class="input-dark text-center" placeholder="Away" oninput="runVig()">
                            </div>
                            <div class="text-center text-gray-500 mt-2">åº„å®¶æŠ½æ°´: <span id="vig-margin" class="text-red-400">5.26%</span></div>
                            <div class="bg-black/50 p-3 rounded border border-gray-700 text-center">
                                <div class="text-gray-500 mb-1">çœŸå®æ— æ°´èµ”ç‡</div>
                                <div class="text-xl font-mono text-emerald-400" id="vig-true">2.00</div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- æ¯”èµ›è¯¦æƒ…å¼¹çª— -->
    <div id="match-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="absolute inset-x-0 bottom-0 md:inset-0 md:flex md:items-center md:justify-center pointer-events-none">
            <div class="bg-[#0f0f0f] md:rounded-2xl md:max-w-xl w-full p-6 border border-gray-800 shadow-2xl pointer-events-auto" id="modal-panel">
                <div id="modal-content"></div>
                <button onclick="closeModal()" class="mt-6 w-full bg-gray-800 text-white py-3 rounded-xl font-bold hover:bg-gray-700">Close</button>
            </div>
        </div>
    </div>

    <!-- ğŸš€ é€»è¾‘å¼•æ“ -->
    <script>
        // --- é…ç½®ä¸­å¿ƒ ---
        const SUPABASE_URL = 'https://ncubbsgzebbmoqslyukd.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_sVNMF9y0NlYxSqjqKqwySw_b1DJyEdg'; // Public Key
        
        let liveData = [];
        let eplData = [];

        // --- å…œåº•æ•°æ® (Mock) - ä¿è¯æ°¸è¿œæœ‰å†…å®¹æ˜¾ç¤º ---
        const MOCK_LIVE = [
            { league: "Premier League", home_team: "Man City", away_team: "Liverpool", score: "1-1", time: "88", pressure_val: 92, recommendation: "ä¸»é˜Ÿç–¯ç‹‚è¿›æ”»ï¼Œå‹åŠ›å€¼çˆ†è¡¨ï¼Œå»ºè®®å¤§çƒ" },
            { league: "La Liga", home_team: "Real Madrid", away_team: "Barcelona", score: "0-0", time: "23", pressure_val: 45, recommendation: "åœºé¢ç„¦ç¼ï¼Œæš‚æ— æ˜æ˜¾æœºä¼š" }
        ];
        const MOCK_EPL = [
            { start_date: "2025-11-22T12:30:00Z", home_team: "Burnley", away_team: "Chelsea", venue: "Turf Moor", home_logo: "https://cdn.opticodds.com/team-logos/soccer/3763.png", away_logo: "https://cdn.opticodds.com/team-logos/soccer/4009.png", win_prob_home: 14, win_prob_draw: 21, win_prob_away: 65 }
        ];
        const ADS = [
            { type: "ad", content: { brand: "ğŸ‘‘ å®˜æ–¹æ¨è: GSlot16", title: "å…¨ç½‘æœ€ç¨³è€è™æœº", desc: "ç§’å……ç§’æã€‚OddsFlow ä¸“äº«çº¢åˆ©ã€‚", btn_text: "è¿›å…¥å®˜ç½‘", link: "https://gslot16.com?ag=RS-c2VzYW1lcmFiYml0" } },
            { type: "ad", content: { brand: "âš½ BK8 äºšæ´²ç¬¬ä¸€", title: "OddsFlow åˆä½œä¼™ä¼´", desc: "é¦–å­˜é€ 200%ã€‚", btn_text: "é¢†å–ç¦åˆ©", link: "https://www.bk8.com/" } }
        ];

        // --- åˆå§‹åŒ– ---
        window.onload = function() {
            initData();
            switchTab('home');
            
            // è®¡ç®—å™¨äº‹ä»¶ç›‘å¬
            document.getElementById('kelly-win').addEventListener('input', (e)=>{ 
                document.getElementById('k-win-val').innerText = e.target.value + '%'; runKelly(); 
            });
        };

        async function initData() {
            try {
                // 1. å…ˆåŠ è½½ Mock æ•°æ® (ç¬é—´å±•ç¤º)
                processData(MOCK_LIVE, MOCK_EPL);

                // 2. å†å°è¯•è¿æ¥ Supabase (å¼‚æ­¥æ›´æ–°)
                const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                const [resLive, resEPL] = await Promise.all([
                    supabase.from('live_signals').select('*').order('created_at', { ascending: false }).limit(20),
                    supabase.from('upcoming_epl').select('*').order('created_at', { ascending: false })
                ]);

                if(resLive.data && resLive.data.length > 0) processData(resLive.data, resEPL.data || MOCK_EPL);

            } catch (e) { console.log("Using offline mode."); }
        }

        function processData(rawLive, rawEPL) {
            // å¤„ç† Live
            liveData = rawLive.map(m => ({ type: 'match', result: m.recommendation ? { match_info: m, beginner_friendly_text: m.recommendation } : { match_info: m, beginner_friendly_text: m.recommendation } }));
            // æ’å…¥å¹¿å‘Š
            if(liveData.length > 0) liveData.splice(1, 0, ADS[0]);
            if(liveData.length > 2) liveData.splice(3, 0, ADS[1]);
            
            // å¤„ç† EPL
            eplData = rawEPL && rawEPL.length > 0 ? rawEPL : MOCK_EPL;
            
            // æ¸²æŸ“
            renderLive();
            renderEPL();
        }

        // --- æ¸²æŸ“å‡½æ•° ---
        function renderLive() {
            const el = document.getElementById('match-container');
            if(!el) return;
            let html = '';
            liveData.forEach((item, i) => {
                if(item.type === 'ad') {
                    html += `<div class="bg-gradient-to-r from-yellow-900/40 to-black p-4 rounded-xl border border-yellow-500/50 flex justify-between items-center"><div class="flex items-center gap-3"><div class="text-2xl">ğŸ</div><div><div class="text-yellow-400 font-bold text-xs">${item.content.brand}</div><div class="text-white font-bold text-sm">${item.content.desc}</div></div></div><a href="${item.content.link}" target="_blank" class="bg-yellow-500 text-black px-3 py-1.5 rounded text-xs font-bold">GO</a></div>`;
                } else {
                    const m = item.result.match_info || item.result; // å…¼å®¹
                    const p = parseInt(m.pressure_val) || 50;
                    html += `<div onclick="openModal('live', ${i})" class="bg-glass p-4 rounded-xl border-l-2 border-emerald-500 cursor-pointer hover:bg-white/5 transition mb-2"><div class="flex justify-between text-[10px] text-gray-400 mb-2"><span>${m.league || 'League'} â€¢ ${m.time || 'Live'}'</span><span class="text-emerald-400">Live Signal</span></div><div class="flex justify-between items-center mb-2"><span class="font-bold text-white w-1/3 truncate text-right">${m.home_team || 'Home'}</span><span class="bg-black/50 px-2 py-0.5 rounded text-white font-mono mx-2">${m.score || '0-0'}</span><span class="font-bold text-white w-1/3 truncate text-left">${m.away_team || 'Away'}</span></div><div class="h-1.5 bg-gray-800 rounded-full overflow-hidden flex"><div style="width: ${p}%" class="bg-blue-500 h-full"></div><div style="width: ${100-p}%" class="bg-red-500 h-full"></div></div></div>`;
                }
            });
            el.innerHTML = html;
        }

        function renderEPL() {
            const el = document.getElementById('epl-container');
            if(!el) return;
            let html = '';
            eplData.forEach((m, i) => {
                html += `<div onclick="openModal('epl', ${i})" class="bg-[#1a1a1a] p-4 rounded-xl border border-purple-900/30 cursor-pointer hover:border-purple-500 transition relative overflow-hidden"><div class="absolute top-0 left-0 bg-purple-600 text-[8px] px-2 py-0.5 text-white rounded-br">EPL</div><div class="flex justify-between items-center mt-2"><div class="text-center"><img src="${m.home_logo}" class="w-8 h-8 mx-auto mb-1"><div class="text-xs text-white">${m.home_team}</div></div><div class="text-gray-600 font-mono font-bold">VS</div><div class="text-center"><img src="${m.away_logo}" class="w-8 h-8 mx-auto mb-1"><div class="text-xs text-white">${m.away_team}</div></div></div></div>`;
            });
            el.innerHTML = html;
        }

        // --- é¡µé¢äº¤äº’ ---
        function switchTab(id) {
            document.querySelectorAll('.page-section').forEach(e => e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.classList.remove('bg-white/10', 'text-white'); btn.classList.add('text-gray-400');
                if(btn.getAttribute('onclick').includes(id)) { btn.classList.add('bg-white/10', 'text-white'); btn.classList.remove('text-gray-400'); }
            });
        }

        function openCalcModal() { document.getElementById('calc-modal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('match-modal').classList.add('hidden'); }

        function openModal(type, i) {
            let content = '';
            if(type === 'live') {
                const m = liveData[i].result.match_info || liveData[i].result;
                const ai = liveData[i].result.beginner_friendly_text || m.recommendation || 'Analyzing...';
                content = `<div class="text-center"><h3 class="text-xl font-bold text-white mb-2">${m.home_team} vs ${m.away_team}</h3><p class="text-emerald-400 text-sm font-bold mb-4">AI Insight</p><p class="text-gray-300 text-sm bg-white/5 p-4 rounded-lg text-left">${ai}</p></div>`;
            } else {
                const m = eplData[i];
                const p = { h: m.win_prob_home||33, d: m.win_prob_draw||33, a: m.win_prob_away||34 };
                content = `<div class="text-center mb-4"><div class="text-purple-400 font-bold text-xs mb-2">WIN PROBABILITY</div><div class="flex h-4 rounded-full overflow-hidden"><div style="width: ${p.h}%" class="bg-red-600 text-[8px] text-white flex items-center justify-center">${p.h}%</div><div style="width: ${p.d}%" class="bg-gray-600"></div><div style="width: ${p.a}%" class="bg-blue-600 text-[8px] text-white flex items-center justify-center">${p.a}%</div></div></div>`;
            }
            document.getElementById('modal-content').innerHTML = content;
            document.getElementById('match-modal').classList.remove('hidden');
        }

        // --- 3åˆ1 è®¡ç®—å™¨é€»è¾‘ ---
        function switchCalc(type) {
            document.querySelectorAll('.calc-content').forEach(e => e.classList.add('hidden'));
            document.getElementById('tab-'+type).classList.remove('hidden');
            document.querySelectorAll('.calc-tab').forEach(e => { e.classList.remove('bg-gray-800', 'text-white', 'border-b-2', 'border-emerald-500'); e.classList.add('text-gray-500'); });
            event.target.classList.add('bg-gray-800', 'text-white', 'border-b-2', 'border-emerald-500');
            event.target.classList.remove('text-gray-500');
        }
        
        function runKelly() {
            const w = parseFloat(document.getElementById('k-win').value)/100;
            const o = parseFloat(document.getElementById('k-odds').value);
            const b = parseFloat(document.getElementById('k-bank').value);
            if(o<=1) return;
            const f = (((o-1)*w)-(1-w))/(o-1);
            document.getElementById('k-res').innerText = f>0 ? '$'+(b*f).toFixed(0) : '$0';
        }
        function runArb() {
            const o1 = parseFloat(document.getElementById('arb-o1').value);
            const o2 = parseFloat(document.getElementById('arb-o2').value);
            const t = parseFloat(document.getElementById('arb-stake').value);
            if(!o1||!o2) return;
            const imp = (1/o1 + 1/o2)*100;
            const prof = 100-imp;
            document.getElementById('arb-profit-pct').innerHTML = `Profit: <span class="${prof>0?'text-emerald-400':'text-red-400'}">${prof.toFixed(2)}%</span>`;
            if(prof>0) {
                const s1 = (t*(1/o1))/(1/o1+1/o2);
                document.getElementById('arb-s1').innerText = '$'+s1.toFixed(2);
                document.getElementById('arb-s2').innerText = '$'+(t-s1).toFixed(2);
            }
        }
        function runVig() {
            const o1 = parseFloat(document.getElementById('vig-o1').value);
            const o2 = parseFloat(document.getElementById('vig-o2').value);
            if(!o1||!o2) return;
            const m = (1/o1+1/o2)-1;
            const t = 1/((1/o1)/(1+m));
            document.getElementById('vig-margin').innerText = (m*100).toFixed(2)+'%';
            document.getElementById('vig-true').innerText = t.toFixed(2);
        }

        // --- å¤šè¯­è¨€ ---
        const trans = {
            zh: { menu_home: "é¦–é¡µ", menu_terminal: "å®æ—¶ç»ˆç«¯", menu_epl: "è‹±è¶…å‰ç»", menu_calc: "äº¤æ˜“è®¡ç®—å™¨", menu_guide: "æ•™ç¨‹", hero_h1_1: "æ•°æ®é©±åŠ¨", hero_h1_2: "ç²¾å‡†è·åˆ©ã€‚", hero_sub: "è¿™ä¸æ˜¯èµŒåšï¼Œè¿™æ˜¯åŸºäº N8N è‡ªåŠ¨åŒ–ä¸ Supabase å¤§æ•°æ®çš„ä½“è‚²å¥—åˆ©äº¤æ˜“ã€‚", btn_start: "å¯åŠ¨ç›‘æ§", btn_calc: "è®¡ç®—å™¨", btn_connect: "è¿æ¥è´¦æˆ·" },
            en: { menu_home: "Home", menu_terminal: "Live Terminal", menu_epl: "EPL Data", menu_calc: "Calculators", menu_guide: "Guide", hero_h1_1: "Data Driven,", hero_h1_2: "Precision Profit.", hero_sub: "Stop gambling. Start arbitrage trading powered by N8N & Supabase big data.", btn_start: "Launch System", btn_calc: "Calculators", btn_connect: "Connect Wallet" },
            es: { menu_home: "Inicio", menu_terminal: "Terminal", menu_epl: "Datos EPL", menu_calc: "Calculadora", menu_guide: "GuÃ­a", hero_h1_1: "Impulsado por Datos,", hero_h1_2: "Beneficio Preciso.", hero_sub: "Deja de apostar. Empieza a operar con arbitraje deportivo.", btn_start: "Iniciar", btn_calc: "Calculadora", btn_connect: "Conectar" },
            pt: { menu_home: "InÃ­cio", menu_terminal: "Terminal", menu_epl: "Dados EPL", menu_calc: "Calc", menu_guide: "Guia", hero_h1_1: "Guiado por Dados,", hero_h1_2: "Lucro Preciso.", hero_sub: "Pare de apostar. Comece a negociar com arbitragem esportiva.", btn_start: "LanÃ§ar", btn_calc: "Calc", btn_connect: "Conectar" },
            id: { menu_home: "Beranda", menu_terminal: "Terminal", menu_epl: "Data EPL", menu_calc: "Kalkulator", menu_guide: "Panduan", hero_h1_1: "Berbasis Data,", hero_h1_2: "Keuntungan Tepat.", hero_sub: "Berhenti berjudi. Mulai trading arbitrase olahraga.", btn_start: "Mulai", btn_calc: "Kalkulator", btn_connect: "Hubungkan" },
            ms: { menu_home: "Utama", menu_terminal: "Terminal", menu_epl: "Data EPL", menu_calc: "Kira", menu_guide: "Panduan", hero_h1_1: "Dipacu Data,", hero_h1_2: "Untung Tepat.", hero_sub: "Berhenti berjudi. Mula berdagang arbitraj sukan.", btn_start: "Lancar", btn_calc: "Kira", btn_connect: "Sambung" }
        };
        function setLang(l) {
            const codes = {'zh':'CN','en':'EN','es':'ES','pt':'BR','id':'ID','ms':'MY'};
            document.getElementById('current-lang').innerText = codes[l];
            document.querySelectorAll('[data-i18n]').forEach(e => { if(trans[l][e.dataset.i18n]) e.innerText = trans[l][e.dataset.i18n]; });
        }
    </script>
</body>
</html>
