<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OddsFlow AI - æ™ºèƒ½è¶³çƒäº¤æ˜“ç»ˆç«¯</title>
    <meta name="description" content="OddsFlow AI - å®æ—¶è¶³çƒèµ”ç‡ç›‘æ§ä¸è‹±è¶…å¤§æ•°æ®åˆ†æã€‚">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Chart.jsç”¨äºç”»å›¾ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: #e5e7eb; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* ç»ç’ƒæ‹Ÿæ€ */
        .bg-glass { 
            background: rgba(20, 20, 20, 0.6); 
            backdrop-filter: blur(12px); 
            border: 1px solid rgba(255, 255, 255, 0.05); 
        }
        .sidebar-glass {
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        /* åŠ¨ç”» */
        @keyframes pulse-green { 0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); } }
        .live-dot { animation: pulse-green 2s infinite; }
        
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        .animate-float { animation: float 6s ease-in-out infinite; }

        /* éšè—æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        
        .page-section { display: none; opacity: 0; transition: opacity 0.3s ease-in-out; }
        .page-section.active { display: block; opacity: 1; }
    </style>
</head>
<body class="antialiased h-screen flex overflow-hidden text-sm">

    <!-- 1. å·¦ä¾§è¾¹æ  (Sidebar) - å¯¹æ ‡ç«å“ -->
    <aside class="w-64 sidebar-glass flex-col hidden md:flex z-50">
        <!-- Logo -->
        <div class="h-16 flex items-center px-6 border-b border-white/5">
            <div class="w-8 h-8 bg-emerald-600 rounded flex items-center justify-center text-white mr-3 font-bold shadow-lg shadow-emerald-500/20">
                <i class="fas fa-bolt"></i>
            </div>
            <span class="font-bold text-lg text-white tracking-tight">OddsFlow</span>
        </div>

        <!-- èœå• -->
        <nav class="flex-1 p-4 space-y-1 overflow-y-auto">
            <p class="px-3 text-[10px] font-bold text-gray-500 uppercase tracking-wider mb-2 mt-2">Main Menu</p>
            
            <button onclick="switchTab('home')" class="nav-item w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/5 hover:text-white transition group">
                <i class="fas fa-home w-6 text-center mr-2 group-hover:text-emerald-400 transition"></i> é¦–é¡µæ¦‚è§ˆ
            </button>
            
            <button onclick="switchTab('dashboard')" class="nav-item w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/5 hover:text-white transition group">
                <i class="fas fa-satellite-dish w-6 text-center mr-2 group-hover:text-red-400 transition animate-pulse"></i> 
                <span>å®æ—¶ç»ˆç«¯</span>
                <span class="ml-auto bg-red-500/20 text-red-400 text-[10px] px-1.5 rounded">LIVE</span>
            </button>
            
            <button onclick="switchTab('epl')" class="nav-item w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/5 hover:text-white transition group">
                <i class="fas fa-shield-alt w-6 text-center mr-2 group-hover:text-purple-400 transition"></i> è‹±è¶…å‰ç»
            </button>

            <p class="px-3 text-[10px] font-bold text-gray-500 uppercase tracking-wider mb-2 mt-6">Tools</p>
            
            <button onclick="openCalcModal()" class="w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/5 hover:text-white transition group">
                <i class="fas fa-calculator w-6 text-center mr-2"></i> å‡¯åˆ©è®¡ç®—å™¨
            </button>
            
            <button onclick="switchTab('guide')" class="nav-item w-full flex items-center px-3 py-2.5 rounded-lg text-gray-400 hover:bg-white/5 hover:text-white transition group">
                <i class="fas fa-book w-6 text-center mr-2"></i> ä½¿ç”¨æ•™ç¨‹
            </button>
        </nav>

        <!-- åº•éƒ¨ç”¨æˆ·åŒº -->
        <div class="p-4 border-t border-white/5">
            <a href="https://t.me/footballscbet_bot" target="_blank" class="flex items-center gap-3 p-3 rounded-xl bg-gradient-to-r from-emerald-900/50 to-emerald-800/50 border border-emerald-500/20 hover:border-emerald-500/50 transition cursor-pointer group">
                <div class="w-8 h-8 rounded-full bg-emerald-500 flex items-center justify-center text-black font-bold">
                    <i class="fas fa-crown"></i>
                </div>
                <div>
                    <div class="text-xs font-bold text-white group-hover:text-emerald-400 transition">å‡çº§ PRO ç‰ˆ</div>
                    <div class="text-[10px] text-gray-400">è§£é”å…¨éƒ¨åŠŸèƒ½ ></div>
                </div>
            </a>
        </div>
    </aside>

    <!-- å³ä¾§ä¸»åŒºåŸŸ -->
    <div class="flex-1 flex flex-col h-full relative">
        
        <!-- ç§»åŠ¨ç«¯é¡¶éƒ¨æ  (ä»…åœ¨æ‰‹æœºæ˜¾ç¤º) -->
        <div class="md:hidden h-14 bg-black border-b border-gray-800 flex items-center justify-between px-4 z-50">
            <div class="flex items-center gap-2">
                <i class="fas fa-bolt text-emerald-500"></i>
                <span class="font-bold text-white">OddsFlow</span>
            </div>
            <button onclick="document.querySelector('aside').classList.toggle('hidden'); document.querySelector('aside').classList.toggle('absolute'); document.querySelector('aside').classList.toggle('h-full');" class="text-gray-400"><i class="fas fa-bars text-xl"></i></button>
        </div>

        <!-- é¡¶éƒ¨çŠ¶æ€æ¡ -->
        <header class="h-14 border-b border-white/5 bg-black/20 backdrop-blur flex items-center justify-between px-6 shrink-0">
            <div class="flex items-center gap-2 text-xs text-gray-400">
                <span class="w-2 h-2 bg-emerald-500 rounded-full live-dot"></span>
                System Status: <span class="text-emerald-400">Operational</span>
            </div>
            <div class="flex items-center gap-4">
                <a href="https://gslot16.com?ag=RS-c2VzYW1lcmFiYml0" target="_blank" class="text-xs font-bold text-yellow-500 hover:text-yellow-400 flex items-center gap-1">
                    <i class="fas fa-coins"></i> GSlot16 ä½™é¢æŸ¥è¯¢
                </a>
                <div class="w-px h-4 bg-gray-700"></div>
                <button class="text-gray-400 hover:text-white"><i class="fas fa-bell"></i></button>
            </div>
        </header>

        <!-- å†…å®¹æ»šåŠ¨åŒº -->
        <div class="flex-1 overflow-y-auto p-4 md:p-8 relative" id="main-view">
            
            <!-- èƒŒæ™¯è£…é¥° -->
            <div class="absolute top-0 left-0 w-full h-[500px] bg-gradient-to-b from-emerald-900/10 to-transparent pointer-events-none"></div>

            <!-- HOME SECTION (è§†è§‰å‡çº§ç‰ˆ) -->
            <section id="home" class="page-section active max-w-6xl mx-auto">
                <div class="flex flex-col lg:flex-row items-center gap-12 pt-10">
                    
                    <!-- å·¦ä¾§ï¼šæ–‡æ¡ˆ -->
                    <div class="flex-1 text-center lg:text-left z-10">
                        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 text-emerald-400 text-[10px] font-bold mb-6">
                            <span class="bg-emerald-500 w-1.5 h-1.5 rounded-full animate-ping"></span>
                            v13.0 LIVE SYSTEM
                        </div>
                        <h1 class="text-5xl lg:text-7xl font-black text-white mb-6 leading-tight">
                            æ•°æ®é©±åŠ¨<br>
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-500">ç²¾å‡†äº¤æ˜“ã€‚</span>
                        </h1>
                        <p class="text-gray-400 text-lg mb-8 leading-relaxed max-w-lg mx-auto lg:mx-0">
                            ä¸åƒå…¶ä»–äººé è¿æ°”ã€‚æˆ‘ä»¬æä¾› <strong>å®æ—¶å‹åŠ›æŒ‡æ•°</strong>ã€<strong>ä»·å€¼æ³¨æ¨¡å‹</strong> å’Œ <strong>ç»æ€é¢„è­¦</strong>ã€‚åšåº„å®¶çš„å¯¹æ‰‹ï¼Œè€Œä¸æ˜¯çŒç‰©ã€‚
                        </p>
                        <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                            <button onclick="switchTab('dashboard')" class="px-8 py-4 bg-emerald-600 hover:bg-emerald-500 text-white font-bold rounded-xl shadow-lg shadow-emerald-500/20 transition flex items-center justify-center gap-2">
                                <i class="fas fa-play"></i> å¯åŠ¨ç»ˆç«¯
                            </button>
                            <button onclick="switchTab('epl')" class="px-8 py-4 bg-white/5 border border-white/10 hover:bg-white/10 text-white font-bold rounded-xl transition">
                                æŸ¥çœ‹è‹±è¶…æ•°æ®
                            </button>
                        </div>
                        
                        <!-- ä¿¡ä»»èƒŒä¹¦ -->
                        <div class="mt-10 flex items-center justify-center lg:justify-start gap-6 text-gray-500 text-xs font-mono">
                            <div class="flex items-center gap-2"><i class="fas fa-check-circle text-emerald-500"></i> N8N Verified</div>
                            <div class="flex items-center gap-2"><i class="fas fa-check-circle text-emerald-500"></i> Low Latency</div>
                            <div class="flex items-center gap-2"><i class="fas fa-check-circle text-emerald-500"></i> 24/7 Uptime</div>
                        </div>
                    </div>

                    <!-- å³ä¾§ï¼šåŠ¨æ€ä»ªè¡¨ç›˜æ¼”ç¤º (Mockup) -->
                    <div class="flex-1 w-full max-w-md lg:max-w-full relative animate-float">
                        <!-- è¿™æ˜¯ä¸€ä¸ªçº¯ CSS ç”»å‡ºæ¥çš„æ¨¡æ‹Ÿç»ˆç«¯çª—å£ -->
                        <div class="bg-[#0F1115] border border-gray-700 rounded-xl shadow-2xl overflow-hidden relative">
                            <!-- çª—å£å¤´éƒ¨ -->
                            <div class="h-8 bg-[#161b22] border-b border-gray-700 flex items-center px-3 gap-2">
                                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                <div class="ml-4 text-[10px] text-gray-500 font-mono">oddsflow_terminal.exe</div>
                            </div>
                            <!-- çª—å£å†…å®¹ -->
                            <div class="p-6 font-mono text-xs">
                                <div class="flex justify-between mb-4 text-gray-400">
                                    <span>TARGET: <span class="text-white font-bold">Man City</span></span>
                                    <span>STATUS: <span class="text-emerald-400 animate-pulse">MONITORING</span></span>
                                </div>
                                <!-- æ¨¡æ‹Ÿå›¾è¡¨ -->
                                <div class="h-32 border-b border-gray-800 mb-4 relative">
                                    <!-- ç”¨ Canvas ç”»ä¸ªç®€å•çš„çº¿ -->
                                    <canvas id="heroChart" class="w-full h-full"></canvas>
                                    <div class="absolute top-10 right-10 bg-red-500/20 border border-red-500 text-red-400 px-2 py-1 rounded text-[10px]">
                                        âš ï¸ HIGH PRESSURE
                                    </div>
                                </div>
                                <div class="space-y-2">
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">Dangerous Attacks</span>
                                        <div class="w-32 h-2 bg-gray-800 rounded-full overflow-hidden">
                                            <div class="h-full bg-emerald-500 w-[85%]"></div>
                                        </div>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">xG (Expected Goals)</span>
                                        <span class="text-white">2.45 vs 0.32</span>
                                    </div>
                                    <div class="p-2 bg-emerald-900/20 border border-emerald-500/30 rounded mt-2 text-emerald-400">
                                        > AI Recommendation: Over 2.5 Goals
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- è£…é¥°å…‰ -->
                        <div class="absolute -z-10 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[120%] h-[120%] bg-emerald-500/20 blur-[80px]"></div>
                    </div>
                </div>
            </section>

            <!-- DASHBOARD SECTION -->
            <section id="dashboard" class="page-section">
                <div class="flex justify-between items-end mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-white">Live Feed</h2>
                        <p class="text-xs text-gray-500">Real-time market data</p>
                    </div>
                    <div class="text-[10px] text-gray-500 font-mono">UPDATED: JUST NOW</div>
                </div>
                <div class="grid gap-4" id="match-container">
                    <div class="text-center py-20 text-gray-500">Connecting...</div>
                </div>
            </section>

            <!-- EPL SECTION -->
            <section id="epl" class="page-section">
                <div class="flex justify-between items-end mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-purple-400">EPL Fixtures</h2>
                        <p class="text-xs text-gray-500">Premier League Analysis</p>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4" id="epl-container">
                    <div class="text-center py-20 text-gray-500 col-span-2">Loading EPL Data...</div>
                </div>
            </section>

            <!-- PRICING SECTION -->
            <section id="pricing" class="page-section">
                <div class="max-w-4xl mx-auto text-center pt-10">
                    <h2 class="text-3xl font-bold mb-4">Simple Pricing</h2>
                    <div class="bg-gradient-to-b from-gray-800 to-black border border-emerald-500 p-8 rounded-3xl max-w-sm mx-auto shadow-2xl shadow-emerald-900/20">
                        <div class="text-emerald-400 font-bold mb-2">PRO ACCESS</div>
                        <div class="text-5xl font-bold text-white mb-2">RM 68<span class="text-lg text-gray-500">/mo</span></div>
                        <ul class="text-left text-sm text-gray-400 space-y-3 my-8 pl-4">
                            <li><i class="fas fa-check text-emerald-500 mr-2"></i> Real-time Signals</li>
                            <li><i class="fas fa-check text-emerald-500 mr-2"></i> Telegram Bot</li>
                            <li><i class="fas fa-check text-emerald-500 mr-2"></i> Value Bets</li>
                        </ul>
                        <a href="https://t.me/footballscbet_bot" target="_blank" class="block w-full py-4 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold transition">Get Started</a>
                    </div>
                </div>
            </section>

            <!-- GUIDE SECTION -->
            <section id="guide" class="page-section">
                <div class="max-w-3xl mx-auto pt-10">
                    <h2 class="text-2xl font-bold mb-6">ä½¿ç”¨æ•™ç¨‹</h2>
                    <div class="space-y-4">
                        <div class="bg-glass p-6 rounded-xl">
                            <h3 class="text-emerald-400 font-bold mb-2">1. å‹åŠ›æŒ‡æ•° (Pressure Index)</h3>
                            <p class="text-gray-400 text-sm">å½“çº¢è‰²æ¡è¶…è¿‡ 75% æ—¶ï¼Œè¡¨ç¤ºä¸»é˜Ÿæ­£åœ¨ç–¯ç‹‚å›´æ”»ã€‚è¿™æ˜¯å…¥åœºâ€œä¸»èƒœâ€æˆ–â€œå¤§çƒâ€çš„æœ€ä½³æ—¶æœºã€‚</p>
                        </div>
                        <div class="bg-glass p-6 rounded-xl">
                            <h3 class="text-blue-400 font-bold mb-2">2. ç»æ€é¢„è­¦ (Late Goal)</h3>
                            <p class="text-gray-400 text-sm">å¦‚æœæ¯”èµ›åœ¨ 80 åˆ†é’Ÿåè¿˜æ˜¯å¹³å±€ï¼Œä½†ä¸€æ–¹å‹åŠ›å€¼æé«˜ï¼ŒAI ä¼šå‘é€ç»æ€é¢„è­¦ã€‚</p>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <!-- å¼¹çª—ï¼šæ¯”èµ›è¯¦æƒ… -->
    <div id="match-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="absolute inset-x-0 bottom-0 md:inset-0 md:flex md:items-center md:justify-center pointer-events-none">
            <div class="bg-[#0f0f0f] md:rounded-2xl md:max-w-xl w-full p-6 border border-gray-800 shadow-2xl pointer-events-auto" id="modal-panel">
                <div id="modal-content"></div>
                <button onclick="closeModal()" class="mt-6 w-full bg-gray-800 text-white py-3 rounded-xl font-bold hover:bg-gray-700">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- å¼¹çª—ï¼šè®¡ç®—å™¨ (æ–°å¢åŠŸèƒ½) -->
    <div id="calc-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="document.getElementById('calc-modal').classList.add('hidden')"></div>
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
            <div class="bg-[#1a1a1a] rounded-xl w-80 p-6 border border-gray-700 pointer-events-auto shadow-2xl">
                <h3 class="font-bold text-white mb-4">å‡¯åˆ©å…¬å¼è®¡ç®—å™¨</h3>
                <div class="space-y-3 text-xs">
                    <div>
                        <label class="text-gray-500 block mb-1">ä½ çš„èƒœç‡é¢„ä¼° (%)</label>
                        <input type="number" id="calc-win" class="w-full bg-black border border-gray-700 rounded p-2 text-white" placeholder="e.g. 60">
                    </div>
                    <div>
                        <label class="text-gray-500 block mb-1">èµ”ç‡ (Odds)</label>
                        <input type="number" id="calc-odds" class="w-full bg-black border border-gray-700 rounded p-2 text-white" placeholder="e.g. 2.0">
                    </div>
                    <button onclick="calculateKelly()" class="w-full bg-blue-600 text-white py-2 rounded font-bold mt-2">è®¡ç®—ä»“ä½</button>
                    <div id="calc-result" class="mt-4 text-center font-mono text-emerald-400 font-bold text-lg"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // 1. é…ç½®
        // ==========================================
        const SUPABASE_URL = 'https://ncubbsgzebbmoqslyukd.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_sVNMF9y0NlYxSqjqKqwySw_b1DJyEdg';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        
        let liveData = [];
        let eplData = [];

        const adsData = [
            { type: "ad", content: { brand: "ğŸ‘‘ å®˜æ–¹æ¨è: GSlot16", title: "å…¨ç½‘æœ€ç¨³è€è™æœº", desc: "å¤§é¢æ— å¿§ï¼Œç§’å……ç§’æã€‚", btn_text: "è¿›å…¥ GSlot16", link: "https://gslot16.com?ag=RS-c2VzYW1lcmFiYml0" } },
            { type: "ad", content: { brand: "âš½ BK8 äºšæ´²ç¬¬ä¸€", title: "OddsFlow åˆä½œä¼™ä¼´", desc: "ä½“è‚²èµ”ç‡æœ€é«˜ï¼Œé¦–å­˜é€ 200%ã€‚", btn_text: "é¢†å–ç¦åˆ©", link: "https://www.bk8.com/" } }
        ];

        // ==========================================
        // 2. é¡µé¢æ§åˆ¶
        // ==========================================
        function switchTab(tabId){
            document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            // æ›´æ–°ä¾§è¾¹æ çŠ¶æ€
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.classList.remove('bg-white/10', 'text-white');
                btn.classList.add('text-gray-400');
                if(btn.getAttribute('onclick').includes(tabId)) {
                    btn.classList.add('bg-white/10', 'text-white');
                    btn.classList.remove('text-gray-400');
                }
            });

            if(tabId === 'dashboard') fetchLiveMatches();
            if(tabId === 'epl') fetchEPL();
        }

        function openCalcModal() { document.getElementById('calc-modal').classList.remove('hidden'); }
        
        function calculateKelly() {
            const win = parseFloat(document.getElementById('calc-win').value) / 100;
            const odds = parseFloat(document.getElementById('calc-odds').value);
            if(!win || !odds) return;
            const b = odds - 1;
            const f = ((b * win) - (1 - win)) / b;
            const percent = (f * 100).toFixed(2);
            const res = document.getElementById('calc-result');
            if(f > 0) res.innerText = `å»ºè®®ä»“ä½: ${percent}%`;
            else { res.innerText = "ä¸å»ºè®®ä¸‹æ³¨"; res.style.color = 'red'; }
        }

        // ==========================================
        // 3. æ•°æ®è·å–ä¸æ¸²æŸ“ (å¤ç”¨ä¹‹å‰çš„ç¨³å®šé€»è¾‘)
        // ==========================================
        
        // Live Matches
        async function fetchLiveMatches() {
            const container = document.getElementById('match-container');
            try {
                const { data, error } = await supabase.from('live_signals').select('*').order('created_at', { ascending: false }).limit(20);
                if(error) throw error;
                
                liveData = [];
                if(data && data.length > 0) {
                    data.forEach((m, i) => {
                        liveData.push({ type: 'match', result: m });
                        if(i===0) liveData.push(adsData[0]);
                        if(i===2) liveData.push(adsData[1]);
                    });
                    renderLiveList();
                } else {
                    container.innerHTML = '<div class="text-center text-gray-500 py-20">AI æ‰«æä¸­...</div>';
                }
            } catch(e) { console.error(e); }
        }

        function renderLiveList() {
            const container = document.getElementById('match-container');
            let html = '';
            liveData.forEach((item, index) => {
                if(item.type === 'ad') {
                    html += `<div class="bg-gradient-to-r from-yellow-900/40 to-black p-4 rounded-xl border border-yellow-500/50 flex justify-between items-center"><div class="flex items-center gap-3"><div class="text-2xl">ğŸ</div><div><div class="text-yellow-400 font-bold text-xs">${item.content.brand}</div><div class="text-white font-bold text-sm">${item.content.desc}</div></div></div><a href="${item.content.link}" target="_blank" class="bg-yellow-500 text-black px-3 py-1.5 rounded text-xs font-bold">GO</a></div>`;
                    return;
                }
                const m = item.result;
                const pVal = parseInt(m.pressure_val) || 50;
                html += `<div onclick="openLiveModal(${index})" class="bg-glass p-4 rounded-xl border-l-2 border-emerald-500 cursor-pointer hover:bg-white/5 transition mb-2"><div class="flex justify-between text-[10px] text-gray-400 mb-2"><span>${m.league} â€¢ ${m.time}'</span><span class="text-emerald-400">Live Signal</span></div><div class="flex justify-between items-center mb-2"><span class="font-bold text-white w-1/3 truncate text-right">${m.home_team}</span><span class="bg-black/50 px-2 py-0.5 rounded text-white font-mono mx-2">${m.score}</span><span class="font-bold text-white w-1/3 truncate text-left">${m.away_team}</span></div><div class="h-1.5 bg-gray-800 rounded-full overflow-hidden flex"><div style="width: ${pVal}%" class="bg-blue-500 h-full"></div><div style="width: ${100-pVal}%" class="bg-red-500 h-full"></div></div></div>`;
            });
            container.innerHTML = html;
        }

        // EPL Matches (Mock + Real)
        async function fetchEPL() {
            const container = document.getElementById('epl-container');
            try {
                const { data, error } = await supabase.from('upcoming_epl').select('*').order('created_at', { ascending: false });
                eplData = (data && data.length > 0) ? data : [
                    // Mock Data if empty
                    {
                        start_date: "2025-11-22T12:30:00Z",
                        home_team: "Burnley", away_team: "Chelsea", venue: "Turf Moor",
                        home_logo: "https://cdn.opticodds.com/team-logos/soccer/3763.png",
                        away_logo: "https://cdn.opticodds.com/team-logos/soccer/4009.png",
                        win_prob_home: 14, win_prob_draw: 21, win_prob_away: 65
                    }
                ];
                renderEPLList();
            } catch(e) { console.error(e); }
        }

        function renderEPLList() {
            const container = document.getElementById('epl-container');
            let html = '';
            eplData.forEach((m, index) => {
                html += `<div onclick="openEPLModal(${index})" class="bg-[#1a1a1a] p-4 rounded-xl border border-purple-900/30 cursor-pointer hover:border-purple-500 transition relative overflow-hidden"><div class="absolute top-0 left-0 bg-purple-600 text-[8px] px-2 py-0.5 text-white rounded-br">EPL</div><div class="flex justify-between items-center mt-2"><div class="text-center"><img src="${m.home_logo}" class="w-8 h-8 mx-auto mb-1"><div class="text-xs text-white">${m.home_team}</div></div><div class="text-gray-600 font-mono font-bold">VS</div><div class="text-center"><img src="${m.away_logo}" class="w-8 h-8 mx-auto mb-1"><div class="text-xs text-white">${m.away_team}</div></div></div></div>`;
            });
            container.innerHTML = html;
        }

        // Modals
        function openLiveModal(i) {
            const m = liveData[i].result;
            document.getElementById('modal-content').innerHTML = `<div class="text-center"><div class="text-emerald-400 font-bold mb-2">AI æ´å¯Ÿ</div><p class="text-gray-300 text-sm">${m.recommendation}</p></div>`;
            document.getElementById('match-modal').classList.remove('hidden');
        }
        function openEPLModal(i) {
            const m = eplData[i];
            const prob = { home: m.win_prob_home || 33, draw: m.win_prob_draw || 33, away: m.win_prob_away || 34 };
            document.getElementById('modal-content').innerHTML = `<div class="text-center mb-4"><div class="text-purple-400 font-bold text-xs mb-2">WIN PROBABILITY</div><div class="flex h-4 rounded-full overflow-hidden"><div style="width: ${prob.home}%" class="bg-red-600 text-[8px] text-white flex items-center justify-center">${prob.home}%</div><div style="width: ${prob.draw}%" class="bg-gray-600"></div><div style="width: ${prob.away}%" class="bg-blue-600 text-[8px] text-white flex items-center justify-center">${prob.away}%</div></div><div class="flex justify-between text-xs text-gray-500 mt-1"><span>${m.home_team}</span><span>${m.away_team}</span></div></div>`;
            document.getElementById('match-modal').classList.remove('hidden');
        }
        function closeModal() { document.getElementById('match-modal').classList.add('hidden'); }

        // 4. é¦–é¡µè£…é¥°æ€§å›¾è¡¨ (Canvas)
        const ctx = document.getElementById('heroChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['10\'', '20\'', '30\'', '40\'', '50\'', '60\'', '70\''],
                datasets: [{
                    data: [30, 45, 35, 60, 55, 85, 92],
                    borderColor: '#10b981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { x: { display: false }, y: { display: false } }
            }
        });

        // åˆå§‹åŒ–
        switchTab('home');
    </script>
</body>
</html>
